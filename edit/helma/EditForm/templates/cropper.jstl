<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
	<title><%= param.picture.name encoding='html' %></title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<script type="text/javascript" src="/static/base/js/bootstrap.js"></script>
	<script type="text/javascript" src="/static/edit/js/cropper.js"></script>
	<script>
		$window.addEvent('load', function() {
			var cropper = new Cropper(Hash.merge({
				resize: { width: true, height: true },
				cropperSize: $window.getSize(),
			}, <% json param.cropper %>));

			cropper.confirm = function(){
				var cropInfo = cropper.getCropInfo();
				var preset = cropper.getPreset();
				if ($window.setResult)
					$window.setResult(cropInfo, preset);
				$window.close();
			}
		});
	</script>
	<link href="/static/edit/css/cropper.css" media="screen" rel="Stylesheet" type="text/css">
</head>
<body>
	<div id="imageCropper">
		<div id="cropCanvas">
			<div id="cropLoadingOverlay">
				<h2>loading image...</h2>
			</div>
			<img src="<%= param.picture.getUri() %>" width=<%= param.picture.width %> height=<%= param.picture.height %> id="cropImage">
	    </div>
		<div id="cropBg">
			<div id="cropFooter">
		 		<div id="zoomSlider">
					<div id="zoomSliderHandle"></div>
				</div>
				<div id="cropButtons">
					<input id="cropSubmit" name="commit" type="submit" value="OK">
					<input type="button" value="Cancel" id="cropCancel">
					<input type="button" value="Reset" id="cropReset">
				</div>
			</div>
		</div>
	</div>
</body>
</html>